---
layout: post
title: "安装Gentoo双系统2"
date: 2025-09-08 20:57:44 +0800
categories: blog update
---

好了继续！

从网站安装Gentoo ebuild数据库快照，`emerge-webrsync`。

然后可以选择镜像站点，在make.conf中加一行`GENTOO_MIRRORS="https://mirrors.tuna.tsinghua.edu.cn"`，自己选择合适的镜像站就可以，我使用清华tuna。

## 配置make.conf

接下来选择配置文件，`eselect profile list`，如果显示不全可以使用`eselect profile list | less`，这里我选择`[8] default/linux/amd64/23.0/desktop/plasma/systemd (stable)`（还是得用图形界面），使用`eselect profile set 8`选择。

现在配置USE变量，配置之前可以使用`emerge --info | grep ^USE`查看现有的flag。这个太复杂了，随便找了几个，我使用KDE Plasma，systemd，所以我的USE flag：`USE="systemd system-service policykit dbus X wayland qt5 qt6 png jpeg pulseaudio networkmanager ssl gtk -gnome kde -minimal`，这些USE flag根本不知道用哪个，精简是做不到了。（可以在系统的 /var/db/repos/gentoo/profiles/use.desc 中找到可用的USE标记的完整描述。）

然后配置CPU flags，使用`emerge --ask --oneshot app-portage/cpuid2cpuflags`，安装后可以使用`cpuid2flags`查看flag，然后`echo "*/* $(cpuid2cpuflags)" > /etc/portage/package.use/00cpu-flags`输出到package.use。如果有图形卡也可以设置flag，比如Nvidia的显卡就可以设置`echo "*/* nvidia" > /etc/portage/package.use/00video_cards`。

可以添加许可证配置，一行`ACCEPT_LICENSE="*"`表示接受所有许可证。

现在重新编译系统`emerge --ask --verbose --update --deep --newuse @world`，然后清理无用的包`emerge --ask --pretend --depclean`。

要编译好长时间，休息一下。（我编译了3个小时差不多）。
